---
title: Note — Node.js设计模式(一)
date: 2018/10/3 22:22:22
tags:
  - Node.js
  - Reactor
categories: Node.js
---

# 事件循环

​处理事件多路分解器返回的每个事件。与此同时，保证准备好和每个事件相关联的资源以被读取并且在操作期间不被阻塞。当处理完所有事件后，流再次阻塞事件多路分解器，直到有新的事件再次可用于处理。

>事件多路分解器:
​    此组件收集并排列一套被监视的资源的IO事件，并阻塞他们，直到有新的事件来处理。  

<!--more-->

# Reactor模式

* 主要思想

    让每个IO事件与其处理程序关联（在Node.js里就是回调函数），在事件循环产生并发处理时立即调用相应的处理程序。

* 核心定义
​    通过阻塞来处理IO，直到一组被观察资源的新事件可用，然后将每个事件分派到相关联的处理程序来作出反应。

* 步骤

1.应用程序向**Event Demultiplexer**（事件多路分解器）提交请求来生成新的IO操作。并且应用程序指定一个回调处理程序，当IO操作完成时立即调用处理程序。 提交请求是一种非阻塞过程，会立即将控制权返回给应用程序。

2.当一组IO操作完成时，**Event Demultiplexer**（事件多路分解器）将新的事件推入**EventQueue**（事件队列）。

3.此时**Event Loop**遍历**Event Queue**的项目，对每个事件调用其对应的处理程序。

4.处理程序是应用程序的一部分，它执行完后会将控制权交还给**Event  Loop**。但是在执行处理程序的过程中可能会请求新的异步操作，从而新的操作被插入**Event Demultiplexer**，也就是第一步的过程。

5.当Event Queue项目都被处理完时，循环将阻塞**Event Demultiplexer**，直到有新的事件可用时，触发另一个周期。



与Reactor(反应器)模式对应的是Proactor(主动器)模式